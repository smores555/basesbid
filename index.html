<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Position Bid — Full Cascade (No BPL)</title>
<style>
  :root{ --fg:#101828; --muted:#667085; --bg:#f7f9fc; --card:#fff; --line:#e6eaf0; }
  *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  header{position:sticky;top:0;background:#fff;border-bottom:1px solid var(--line);padding:12px 16px;display:flex;align-items:center;gap:12px;justify-content:space-between;flex-wrap:wrap}
  h1{margin:0;font-size:18px}
  .status{font-size:12px;border:1px solid var(--line);border-radius:999px;padding:3px 10px}
  .ok{background:#eef7ff;border-color:#cfe4ff} .err{background:#fff2f2;border-color:#ffd7dc;color:#a61e2a}
  main{max-width:1400px;margin:0 auto;padding:16px;display:grid;gap:16px;grid-template-columns:420px 1fr}
  @media (max-width: 1100px){ main{grid-template-columns:1fr} }
  .card{background:#fff;border:1px solid var(--line);border-radius:14px;padding:14px}
  .muted{color:var(--muted)}
  table{width:100%;border-collapse:collapse;font-size:13px}
  th,td{padding:8px 10px;border-bottom:1px solid var(--line);text-align:left;white-space:nowrap}
  thead th{position:sticky;top:60px;background:#fbfdff;z-index:1}
  input[type=number]{width:80px;border:1px solid var(--line);border-radius:10px;padding:6px;background:#fff}
  button{border:1px solid var(--line);background:#111;color:#fff;border-radius:10px;padding:6px 10px;cursor:pointer}
  button.ghost{background:#fff;color:#111}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .pill{display:inline-block;padding:2px 8px;border:1px solid var(--line);border-radius:999px;background:#fff;font-size:12px}
  .tag{display:inline-block;padding:2px 8px;border:1px solid var(--line);border-radius:999px;font-size:12px}
  .tag-move{background:#eef2ff;border-color:#d9e1ff} .tag-up{background:#fff6e6;border-color:#ffe1b3} .tag-stay{background:#e9fbf3;border-color:#cfeee1}
</style>
</head>
<body>
<header>
  <div class="row">
    <h1>Position Bid — Full Cascade (No BPL)</h1>
    <span id="status" class="status">Booting…</span>
  </div>
  <div class="row">
    <label class="row" style="font-size:12px">Mode:
      <select id="mode">
        <option value="upgrades">CA Δ = FO→CA upgrades only</option>
        <option value="compete">CA Δ = CA/FO compete by seniority</option>
      </select>
    </label>
    <button id="btnCSV" class="ghost" disabled>Export CSV</button>
  </div>
</header>

<main>
  <aside class="card">
    <div class="row" style="justify-content:space-between">
      <h3 style="margin:0;font-size:14px">Vacancy Controls</h3>
      <label class="row muted" style="font-size:12px"><input id="autoRun" type="checkbox" checked> Auto-run</label>
    </div>
    <div class="muted" style="font-size:12px;margin:6px 0 10px">
      Reads <code>data/capacities.json</code> (or <code>capacities.json.txt</code>), <code>data/roster.json</code>, <code>data/preferences.json</code>.
    </div>

    <div class="row" style="justify-content:space-between;margin-bottom:8px">
      <div class="row">
        <button class="ghost" data-nudge="+1">+1</button>
        <button class="ghost" data-nudge="+5">+5</button>
        <button class="ghost" data-nudge="+10">+10</button>
        <button class="ghost" data-nudge="-1">−1</button>
        <button class="ghost" data-nudge="-5">−5</button>
        <button class="ghost" data-nudge="-10">−10</button>
      </div>
      <button id="btnReset" class="ghost">Reset All Δ to 0</button>
    </div>

    <div id="capGrid" style="max-height:65vh;overflow:auto"></div>
  </aside>

  <section class="card">
    <div class="row" style="justify-content:space-between">
      <div class="row">
        <strong>Awards</strong>
        <input id="q" type="text" placeholder="Search name or seniority…" style="width:220px;margin-left:10px"/>
        <select id="fltMove">
          <option value="all">All awards</option>
          <option value="movers">Movers only</option>
          <option value="upgrades">Upgrades only</option>
        </select>
        <select id="fltBase"><option value="">Awarded Base: All</option></select>
        <select id="fltSeat"><option value="">Awarded Seat: All</option><option>CA</option><option>FO</option></select>
        <button id="btnClear" class="ghost">Clear</button>
      </div>
      <div class="row">
        <span class="pill">Shown <b id="shown">0</b></span>
        <span class="pill">Total <b id="total">0</b></span>
        <span class="pill">Upgrades <b id="upCnt">0</b></span>
        <span class="pill">Movers <b id="mvCnt">0</b></span>
      </div>
    </div>
    <div id="results" style="max-height:68vh;overflow:auto;margin-top:8px">
      <div class="muted">Loading data and running cascade…</div>
    </div>
  </section>
</main>

<script src="app_full.js"></script>
</body>
</html>
