<body>
<div class="app-grid">
  <div class="sidebar">
    <div style="font-weight:800; font-size:18px; color:white; display:flex; justify-content:space-between; align-items:center;">
      <span>ProTrace <span style="color:var(--accent)">Mobile</span></span>
      <span id="status" style="font-size:10px; color:var(--success); border:1px solid var(--success); padding:2px 6px; border-radius:4px">Ready</span>
    </div>
    
    <div class="panel">
      <div class="panel-head">Simulation Controls</div>
      <div style="padding:16px; gap:12px; display:flex; flex-direction:column;">
        <button class="btn-pri" id="runBtn" onclick="run()">RUN BID AWARD</button>
        <div style="display:flex; gap:12px;">
          <button class="btn-sec" id="resetDeltaBtn">Reset Î”</button>
          <button class="btn-sec" onclick="loadJSON()">Reload Data</button>
        </div>
      </div>
    </div>

    <div class="panel" style="max-height: 400px; flex-grow: 1;">
      <div class="panel-head">Base Capacity Setup</div>
      <div id="capTable" style="overflow-y:auto; padding:0;">
        </div>
    </div>

    <div class="panel">
      <div class="panel-head">Seniority Tracking</div>
      <div style="padding:16px;">
        <label style="font-size:10px; color:var(--text-muted); display:block; margin-bottom:5px;">ENTER SENIORITY NUMBER</label>
        <input id="traceQuery" type="number" placeholder="e.g. 2302" value="2302">
      </div>
    </div>
  </div>

  <div class="main">
    <div id="summaryHeader" style="display:none; background:rgba(59, 130, 246, 0.1); border:1px solid var(--accent); border-radius:8px; padding:15px; margin-bottom:10px;">
        <div style="font-size:12px; font-weight:700; color:var(--accent); margin-bottom:5px;">HOLD STATUS SUMMARY</div>
        <div id="gapResults" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; font-family:var(--font-code); font-size:12px;"></div>
    </div>

    <div>
      <div style="font-size:12px; font-weight:700; color:var(--text-muted); margin-bottom:8px;">ACTIVE VACANCIES</div>
      <div id="openVac" class="stats-row"></div>
    </div>

    <div class="ledger-wrap">
      <div class="tabs">
        <div class="tab active" onclick="setTab('ledger')">Ledger</div>
        <div class="tab" onclick="setTab('awards')">Awards</div>
        <div class="tab" onclick="setTab('trace')">Analysis</div>
      </div>

      <div id="view-ledger" class="tab-content active">
        <div class="scroll-box" style="height:100%;"><table class="ledger-table"><tbody id="ledgerBody"></tbody></table></div>
      </div>

      <div id="view-awards" class="tab-content">
        <div id="namesBySen" style="padding:15px; overflow-y:auto; height:100%;"></div>
      </div>

      <div id="view-trace" class="tab-content">
        <div id="traceLog" style="padding:15px; overflow-y:auto; height:100%; background:#000;"></div>
      </div>
    </div>
  </div>
</div>

<script>
// Updated Base list to include SAN
const BASES = ["ANC","PDX","SAN","SEA","SFO"];
const SEATS = ["CA","FO"];

// ... (Existing helper functions like key(), seedVacFromCap(), etc.) ...

function renderUI(moves, cutoffs) {
  const targetSen = Number(document.getElementById('traceQuery').value);
  const summaryHeader = document.getElementById('summaryHeader');
  const gapResults = document.getElementById('gapResults');
  
  summaryHeader.style.display = 'block';
  gapResults.innerHTML = '';

  // Logic to calculate the "Gap" for SAN FO and SAN CA
  [...capMap.keys()].sort().forEach(k => {
    const [b, s] = k.split('__');
    const cutoff = cutoffs[k] || 0;
    
    let statusText = "";
    if (cutoff === 0) {
        statusText = `<span style="color:#666">No Awards</span>`;
    } else {
        const gap = targetSen - cutoff;
        statusText = gap <= 0 ? 
            `<span style="color:var(--success)">HOLD</span>` : 
            `<span style="color:var(--danger)">+${gap} Nos.</span>`;
    }

    gapResults.innerHTML += `
        <div style="border-bottom:1px solid #334155; padding:4px 0;">
            <span style="color:var(--text-muted)">${b} ${s}:</span> ${statusText}
        </div>`;
  });

  // Standard Ledger/Award rendering
  // ... (Same as previous step) ...
}
</script>
</body>
